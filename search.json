[{"path":"https://laszlopecze77.github.io/CPN/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 CPN authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (‚ÄúSoftware‚Äù), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED ‚Äú‚Äù, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Compound Poisson-Normal Regression","text":"many applied settings‚Äîincluding insurance claims, biological systems, environmental monitoring‚Äîobserved data arise random number additive events, event contributes continuous value. natural model data Compound Poisson-Normal (CPN) distribution. CPN model assumes number events follows Poisson distribution, event contributes independent identically distributed (..d.) normally distributed amount. Formally, let: N‚àºPoisson(Œª)N \\sim \\text{Poisson}(\\lambda) denote number events, X1,X2,‚Ä¶,XN‚àº..d.ùí©(Œº,œÉ2)X_1, X_2, \\ldots, X_N \\overset{\\text{..d.}}{\\sim} \\mathcal{N}(\\mu, \\sigma^2), independent NN, total observed outcome modeled compound sum: Y=‚àë=1NXi Y = \\sum_{=1}^{N} X_i resulting distribution YY known Compound Poisson-Normal distribution. first two moments CPN distribution : ùîº[Y]=ŒªŒº,Var(Y)=Œª(Œº2+œÉ2) \\mathbb{E}[Y] = \\lambda \\mu,\\quad \\text{Var}(Y) = \\lambda (\\mu^2 + \\sigma^2) follow properties compound distribution, combining Poisson Gaussian contributions. (approximate) probability density function (pdf) YY : fY(y;Œª,Œº,œÉ)={e‚àíŒª,y=0‚àëk=1Kmaxe‚àíŒªŒªkk!‚ãÖ12œÄkœÉ2exp(‚àí(y‚àíkŒº)22kœÉ2),y‚â†0 f_Y(y; \\lambda, \\mu, \\sigma) = \\begin{cases} e^{-\\lambda}, & \\text{} y = 0 \\\\\\\\ \\sum_{k=1}^{K_{\\text{max}}} \\frac{e^{-\\lambda} \\lambda^k}{k!} \\cdot \\frac{1}{\\sqrt{2\\pi k \\sigma^2}} \\exp\\left( -\\frac{(y - k\\mu)^2}{2k\\sigma^2} \\right), & \\text{} y \\neq 0 \\end{cases} : yy: observed total compound process Œª\\lambda: expected number Poisson events Œº\\mu: mean normal component œÉ\\sigma: standard deviation normal component kk: number events (1 KmaxK_{\\text{max}}) KmaxK_{\\text{max}}: maximum number events used approximation k=0k = 0, sum defined point mass zero, probability : P(Y=0)=P(N=0)=e‚àíŒª P(Y = 0) = P(N = 0) = e^{-\\lambda} theory, compound distribution sums infinite range possible Poisson event counts. practice, sum must truncated finite maximum value KmaxK_{\\max}, chosen remaining tail probability negligible.","code":""},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"getting-started","dir":"Articles","previous_headings":"","what":"Getting Started","title":"Compound Poisson-Normal Regression","text":"use function, load package:","code":"library(CPN)"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"simulating-data","dir":"Articles","previous_headings":"","what":"Simulating Data","title":"Compound Poisson-Normal Regression","text":"‚Äôll simulate dataset mimics typical CPN behavior. includes categorical continuous predictors, outcomes generated via Poisson count normally distributed values.","code":"set.seed(123) data <- simulate_cpn_data() head(data) #            y x1          x2 # 1 -0.5703738  A  0.25331851 # 2  0.0000000  A -0.02854676 # 3  0.9613621  A -0.04287046 # 4  5.3350483  B  1.36860228 # 5  3.1328607  A -0.22577099 # 6 -2.6186645  B  1.51647060"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"plot-the-simulated-data","dir":"Articles","previous_headings":"","what":"Plot the simulated data","title":"Compound Poisson-Normal Regression","text":"Visualize response y predictor x2, colored group x1.","code":"# Scatter plot of y vs x1 stripchart(   y ~ x1, data = data,   vertical = TRUE, method = \"jitter\",   pch = 19, cex = 0.6,   col = c(\"blue\",  \"red\"),   xlab = \"x1\", ylab = \"y\",   main = \"Scatter Plot of y by x1\" )"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"fit-the-cpn-model","dir":"Articles","previous_headings":"","what":"Fit the CPN Model","title":"Compound Poisson-Normal Regression","text":"Fit Compound Poisson-Normal regression model data using standard formula interface. response variable y modeled function predictors x1 (categorical) x2 (continuous).","code":"fit <- cpn(y ~ x1 + x2, data = data)"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"summary-of-results","dir":"Articles","previous_headings":"","what":"Summary of Results","title":"Compound Poisson-Normal Regression","text":"Get summary fitted model, including coefficient estimates, standard errors, z-values, p-values. summary also includes estimates mu sigma parameters (mean SD normal component) model fit statistics like AIC.","code":"summary(fit) # Call: # cpn(formula = y ~ x1 + x2, data = data) #  # Deviance Residuals: #    Min     1Q Median     3Q    Max  # -2.871 -2.059 -1.269  2.181  3.745  #  # Coefficients: #             Estimate Std.Error z.value      Pr.z     # (Intercept)  0.63754   0.15190  4.1969 2.705e-05 *** # x1B         -0.60713   0.22934 -2.6473  0.008114 **  # x2           0.53609   0.10791  4.9679 6.767e-07 *** # --- # Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 #  # Estimated mu parameter: 0.9600 # Estimated sigma parameter: 1.7062 #  # Null deviance: 478.20 on 99 degrees of freedom # Residual deviance: 449.74 on 95 degrees of freedom # AIC: 459.74"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"extracting-model-components","dir":"Articles","previous_headings":"","what":"Extracting Model Components","title":"Compound Poisson-Normal Regression","text":"can directly access key components fitted model object:","code":"fit$coefficients # (Intercept)         x1B          x2  #   0.6375359  -0.6071284   0.5360923 fit$mu #        mu  # 0.9599623 fit$sigma #    sigma  # 1.706243 fit$fitted_values[1:10]  # preview only #  [1] 2.0802264 1.7884887 1.7748077 2.0611074 1.6090445 2.2311441 0.4313962 #  [8] 1.3538511 1.9407450 2.0389587"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"coefficients-and-interpretation","dir":"Articles","previous_headings":"","what":"Coefficients and Interpretation","title":"Compound Poisson-Normal Regression","text":"Use coef() extract model coefficients. Setting full = FALSE shows linear predictor coefficients (excluding auxiliary parameters like mu sigma).","code":"coef(fit) # (Intercept)         x1B          x2          mu       sigma  #   0.6375359  -0.6071284   0.5360923   0.9599623   1.7062428 coef(fit, full = FALSE)  # Includes only linear predictors # (Intercept)         x1B          x2  #   0.6375359  -0.6071284   0.5360923"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"diagnostics-and-residuals","dir":"Articles","previous_headings":"","what":"Diagnostics and Residuals","title":"Compound Poisson-Normal Regression","text":"Basic diagnostic plots residuals help check model fit detect issues like non-linearity outliers.","code":"plot(fit) residuals(fit)[1:10] #  [1] -2.215482 -1.930328 -1.997946  2.411580  2.145066 -2.766042  2.737024 #  [8]  2.297386 -2.398468 -2.008626"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"likelihood-and-information-criteria","dir":"Articles","previous_headings":"","what":"Likelihood and Information Criteria","title":"Compound Poisson-Normal Regression","text":"metrics useful comparing model fit. logLik() gives log-likelihood, AIC() Akaike Information Criterion (lower better), vcov() returns variance-covariance matrix parameters.","code":"logLik(fit) # 'log Lik.' -224.8705 (df=5) AIC(fit) # [1] 459.741 vcov(fit) #              (Intercept)          x1B           x2           mu        sigma # (Intercept)  0.023075014 -0.018395473 -0.002512385 -0.010214396 -0.007321724 # x1B         -0.018395473  0.052596614  0.000287386  0.002777711 -0.001478573 # x2          -0.002512385  0.000287386  0.011644724 -0.002747529 -0.001565976 # mu          -0.010214396  0.002777711 -0.002747529  0.027438819  0.008114203 # sigma       -0.007321724 -0.001478573 -0.001565976  0.008114203  0.033661888"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"type-i-analysis-of-deviance","dir":"Articles","previous_headings":"","what":"Type I Analysis of Deviance","title":"Compound Poisson-Normal Regression","text":"function anova(fit) provides sequential (Type ) analysis deviance. examines incremental contribution predictor model‚Äôs fit, based order appear formula.","code":"anova(fit) #       Term     Df Deviance Resid. Df Resid. Dev   Pr(>Chi) Signif #  Residuals                        97      478.2                   #         x1      1   6.7993        96      471.4  0.0091193     ** #         x2      1   21.657        95     449.74 3.2607e-06    *** # --- # Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"model-update-and-comparison","dir":"Articles","previous_headings":"","what":"Model Update and Comparison","title":"Compound Poisson-Normal Regression","text":"can update model (e.g., remove predictors) compare nested models using likelihood ratio test:","code":"fit2 <- update(fit, . ~ . - x2)  anova(fit, fit2)  # Likelihood ratio test #    Model Resid. Df Resid. Dev     Df Deviance   Pr(>Chi) Signif #  Model 1        95     449.74                                   #  Model 2        96      471.4      1   21.657 3.2607e-06    *** # --- # Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"prediction","dir":"Articles","previous_headings":"","what":"Prediction","title":"Compound Poisson-Normal Regression","text":"fitted Compound Poisson-Normal (CPN) regression model using cpn() function, can generate predictions original data new observations using predict() method cpn objects. method supports three prediction types: ‚Äúlink‚Äù: Returns linear predictor Œ∑=XŒ≤\\eta = X\\beta. ‚Äúrate‚Äù: Returns rate component exp(Œ∑)\\exp(\\eta), representing expected number latent events. ‚Äúresponse‚Äù: Returns expected response ùîº[Y]=Œº‚ãÖexp(Œ∑)\\mathbb{E}[Y] = \\mu \\cdot \\exp(\\eta), combining frequency magnitude components compound distribution. Additionally, confidence intervals can requested using interval = \"confidence\" argument, computes approximate normal-theory confidence intervals using delta method.","code":""},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"predicting-on-the-original-data","dir":"Articles","previous_headings":"Prediction","what":"Predicting on the Original Data","title":"Compound Poisson-Normal Regression","text":"default, predict() uses original dataset used model fitting. can obtain point estimates confidence intervals fitted values.","code":"# Point predictions on the response scale predict(fit, type = \"response\")[1:5] # [1] 2.080226 1.788489 1.774808 2.061107 1.609045  # Confidence intervals for response predictions predict(fit, type = \"response\", interval = \"confidence\")[1:5, ] #        fit       lwr      upr # 1 2.080226 1.1475902 3.012863 # 2 1.788489 0.9814659 2.595511 # 3 1.774808 0.9733248 2.576291 # 4 2.061107 0.8876666 3.234548 # 5 1.609045 0.8722838 2.345805"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"predicting-on-new-data","dir":"Articles","previous_headings":"Prediction","what":"Predicting on New Data","title":"Compound Poisson-Normal Regression","text":"make predictions new data, provide data.frame newdata argument. function internally align factor levels construct appropriate model matrix.","code":"# Define new observations new_df <- data.frame(   x1 = c(\"A\", \"A\", \"B\", \"B\"),   x2 = c(-0.5, -0.2, -0.3, -0.3) )  # Predictions on the link scale (linear predictor Œ∑) predict(fit, newdata = new_df, type = \"link\", interval = \"confidence\") #          fit         lwr       upr # 1  0.3694897  0.03861794 0.7003615 # 2  0.5303174  0.22324817 0.8373866 # 3 -0.1304202 -0.52855693 0.2677165 # 4 -0.1304202 -0.52855693 0.2677165  # Predictions on the rate scale (exp(Œ∑)) predict(fit, newdata = new_df, type = \"rate\", interval = \"confidence\") #         fit      lwr      upr # 1 1.4469960 1.039373 2.014481 # 2 1.6994716 1.250131 2.310321 # 3 0.8777265 0.589455 1.306976 # 4 0.8777265 0.589455 1.306976  # Predictions on the response scale (Œº √ó exp(Œ∑)) predict(fit, newdata = new_df, type = \"response\", interval = \"confidence\") #         fit       lwr      upr # 1 1.3890617 0.7318477 2.046276 # 2 1.6314287 0.8861812 2.376676 # 3 0.8425844 0.4024248 1.282744 # 4 0.8425844 0.4024248 1.282744"},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"confidence-intervals","dir":"Articles","previous_headings":"Prediction","what":"Confidence Intervals","title":"Compound Poisson-Normal Regression","text":"interval = \"confidence\" used: link rate scales, confidence intervals based solely uncertainty regression coefficients (Œ≤\\beta). response scale, intervals additionally incorporate uncertainty mean magnitude parameter (Œº\\mu) using delta method: SE[Œº‚ãÖexp(Œ∑)]‚âà(Œº‚ãÖexp(Œ∑))2‚ãÖVar[Œ∑]+(exp(Œ∑))2‚ãÖVar[Œº] \\text{SE}[\\mu \\cdot \\exp(\\eta)] \\approx \\sqrt{(\\mu \\cdot \\exp(\\eta))^2 \\cdot \\text{Var}[\\eta] + (\\exp(\\eta))^2 \\cdot \\text{Var}[\\mu]} provides accurate reflection total uncertainty predicting expected values compound outcome. ```","code":""},{"path":"https://laszlopecze77.github.io/CPN/articles/CPN-vignette.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Compound Poisson-Normal Regression","text":"CPN package enables effective modeling semicontinuous data using Compound Poisson-Normal model. supports flexible model specification, S3 methods diagnostics inference, prediction new data. advanced use, refer function documentation package reference manual.","code":""},{"path":[]},{"path":"https://laszlopecze77.github.io/CPN/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Laszlo Pecze. Author, maintainer. Fran√ßois Collin. Contributor.","code":""},{"path":"https://laszlopecze77.github.io/CPN/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pecze L (2025). CPN: Compound Poisson-Normal Regression. R package version 0.0.0.9000, https://laszlopecze77.github.io/CPN/.","code":"@Manual{,   title = {CPN: Compound Poisson-Normal Regression},   author = {Laszlo Pecze},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://laszlopecze77.github.io/CPN/}, }"},{"path":[]},{"path":"https://laszlopecze77.github.io/CPN/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Compound Poisson-Normal Regression","text":"Install current development version GitHub :","code":"if (!require(\"remotes\")) install.packages(\"remotes\") remotes::install_github(\"laszlopecze77/CPN\")"},{"path":"https://laszlopecze77.github.io/CPN/index.html","id":"development","dir":"","previous_headings":"","what":"Development","title":"Compound Poisson-Normal Regression","text":"Development dependencies: R version >= 4.5.0 windows machines, rtools45 (https://cran.rstudio.com/bin/windows/Rtools/rtools45/rtools.html) packageroxygen2 version 7.3.2 documentation. package Rdpack citation within function documentation. package devtools ease development. package rmarkdown vignettes. package sessioninfo version 1.2.2 running windows. See current issue https://github.com/r-lib/sessioninfo/issues/112.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/AIC.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Akaike Information Criterion (AIC) for a CPN Model ‚Äî AIC.cpn","title":"Compute Akaike Information Criterion (AIC) for a CPN Model ‚Äî AIC.cpn","text":"Calculates AIC fitted Compound Poisson-Normal (CPN) model.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/AIC.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Akaike Information Criterion (AIC) for a CPN Model ‚Äî AIC.cpn","text":"","code":"# S3 method for class 'cpn' AIC(object, ..., k = 2)"},{"path":"https://laszlopecze77.github.io/CPN/reference/AIC.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Akaike Information Criterion (AIC) for a CPN Model ‚Äî AIC.cpn","text":"object object class \"cpn\", typically produced CPN model fitting function. ... Additional arguments (currently unused). k Numeric penalty per parameter; default 2, corresponding traditional AIC.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/AIC.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Akaike Information Criterion (AIC) for a CPN Model ‚Äî AIC.cpn","text":"numeric value representing AIC model.","code":""},{"path":[]},{"path":"https://laszlopecze77.github.io/CPN/reference/anova.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Analysis of Deviance for CPN Models ‚Äî anova.cpn","title":"Analysis of Deviance for CPN Models ‚Äî anova.cpn","text":"Computes analysis deviance table objects class cpn, either: sequentially model terms (Type ANOVA) one model supplied, comparing two nested models.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/anova.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Analysis of Deviance for CPN Models ‚Äî anova.cpn","text":"","code":"# S3 method for class 'cpn' anova(object, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/anova.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Analysis of Deviance for CPN Models ‚Äî anova.cpn","text":"object object class cpn, typically result call cpn(). ... Optional additional objects class cpn model comparison.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/anova.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Analysis of Deviance for CPN Models ‚Äî anova.cpn","text":"object class \"anova\" inheriting \"data.frame\", containing: one model provided: sequential deviance table added terms. multiple models provided: deviance comparison models.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/anova.cpn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Analysis of Deviance for CPN Models ‚Äî anova.cpn","text":"single model supplied, function refits model terms added sequentially reports change residual deviance. multiple models supplied, assumed nested ordered increasing complexity (based residual degrees freedom). function compares deviances using chi-squared tests.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/anova.cpn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Analysis of Deviance for CPN Models ‚Äî anova.cpn","text":"","code":"# Simulated data set.seed(123) n <- 100 x1 <- rnorm(n) x2 <- factor(sample(c(\"A\", \"B\"), size = n, replace = TRUE))  lambda <- exp(0.5 + 0.2 * x1) N <- rpois(n, lambda) # nolint y <- ifelse(N == 0, 0, rnorm(n, mean = N * 3, sd = sqrt(N) * 2))  data <- data.frame(y = y, x1 = x1, x2 = x2)  # Sequential analysis of deviance fit <- cpn(y ~ x1 + x2, data = data) anova(fit) #>       Term     Df Deviance Resid. Df Resid. Dev Pr(>Chi) Signif #>  Residuals                        97     549.76                 #>         x1      1   5.8002        96     543.96 0.016024      * #>         x2      1  0.45864        95      543.5  0.49826        #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1  # Model comparison fit1 <- cpn(y ~ x1, data = data) fit2 <- cpn(y ~ x1 + x2, data = data) anova(fit1, fit2) #>    Model Resid. Df Resid. Dev     Df Deviance Pr(>Chi) Signif #>  Model 1        95      543.5                                 #>  Model 2        96     543.96      1  0.45864  0.49826        #> --- #> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"},{"path":"https://laszlopecze77.github.io/CPN/reference/coef.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract coefficients from a Compound Poisson-Normal model ‚Äî coef.cpn","title":"Extract coefficients from a Compound Poisson-Normal model ‚Äî coef.cpn","text":"Returns estimated regression coefficients fitted Compound Poisson-Normal (CPN) model. Optionally includes estimated distribution parameters mu sigma.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/coef.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract coefficients from a Compound Poisson-Normal model ‚Äî coef.cpn","text":"","code":"# S3 method for class 'cpn' coef(object, full = TRUE, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/coef.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract coefficients from a Compound Poisson-Normal model ‚Äî coef.cpn","text":"object object class cpn. full Logical. TRUE (default), returns regression coefficients estimated distribution parameters mu sigma. FALSE, returns regression coefficients. ... Additional arguments (currently ignored).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/coef.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract coefficients from a Compound Poisson-Normal model ‚Äî coef.cpn","text":"named numeric vector model coefficients. full = TRUE, includes mu sigma.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Compound Poisson-Normal Regression ‚Äî cpn","title":"Compound Poisson-Normal Regression ‚Äî cpn","text":"Fits Compound Poisson-Normal (CPN) regression model response variable using maximum likelihood estimation via Nelder-Mead method (Nelder Mead 1965) .","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compound Poisson-Normal Regression ‚Äî cpn","text":"","code":"cpn(formula, data = NULL, mu_init = NULL, sigma_init = NULL, k_max = 10)"},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compound Poisson-Normal Regression ‚Äî cpn","text":"formula formula specifying model, e.g., y ~ x1 + x2. data optional data frame, list, environment containing variables model. found data, variables taken environment cpn called. mu_init Optional initial value Normal mean parameter. NULL, set sample mean y. sigma_init Optional initial value Normal standard deviation. NULL, set sample standard deviation y. k_max Upper limit summation used approximating Poisson convolution. 10 100. Default 10.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compound Poisson-Normal Regression ‚Äî cpn","text":"object class \"cpn\" containing following components: coefficients Estimated regression coefficients. mu Estimated mean Normal component. sigma Estimated standard deviation Normal component. se Standard errors estimated parameters. model model frame used. terms terms object model. formula model formula. data original data passed . deviance_residuals Vector deviance residuals. fitted_values Fitted values (Poisson mean times Normal mean). neg_log_likelihood Negative log-likelihood optimum. null_deviance Null model deviance. residual_deviance Residual deviance fitted model. df_null Degrees freedom null model. df_residual Degrees freedom fitted model. k_max Value used truncate Poisson convolution sum. call matched function call.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Compound Poisson-Normal Regression ‚Äî cpn","text":"function fits regression model response assumed follow Compound Poisson-Normal distribution. model estimates regression coefficients Poisson intensity, mean standard deviation Normal component. optimization performed via maximum likelihood using Nelder-Mead method. Standard errors computed via observed information matrix using numerical Hessian. Hessian singular positive definite, warning issued standard errors returned NA.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Compound Poisson-Normal Regression ‚Äî cpn","text":"Nelder JA, Mead R (1965). ‚Äúsimplex method function minimization.‚Äù computer journal, 7(4), 308‚Äì313. doi:10.1093/comjnl/7.4.308 .","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compound Poisson-Normal Regression ‚Äî cpn","text":"","code":"set.seed(123) n <- 100 x <- rnorm(n) lambda <- exp(0.5 + 0.2 * x) N <- rpois(n, lambda) # nolint y <- ifelse(N == 0, 0, rnorm(n, mean = N * 3, sd = sqrt(N) * 2)) data <- data.frame(y = y, x = x) fit <- cpn(y ~ x, data = data) summary(fit) #> Call: #> cpn(formula = y ~ x, data = data) #>  #> Deviance Residuals: #>    Min     1Q Median     3Q    Max  #> -2.741 -2.140 -1.681  2.407  3.149  #>  #> Coefficients: #>             Estimate Std.Error z.value      Pr.z     #> (Intercept)  0.49166   0.12165  4.0414 5.313e-05 *** #> x            0.20931   0.09367  2.2345   0.02545 *   #> --- #> Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1 #>  #> Estimated mu parameter: 2.9067 #> Estimated sigma parameter: 1.5520 #>  #> Null deviance: 534.45 on 99 degrees of freedom #> Residual deviance: 529.60 on 96 degrees of freedom #> AIC: 537.60"},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn_neg_log_likelihood.html","id":null,"dir":"Reference","previous_headings":"","what":"Negative Log-Likelihood for Compound Poisson-Normal Regression ‚Äî cpn_neg_log_likelihood","title":"Negative Log-Likelihood for Compound Poisson-Normal Regression ‚Äî cpn_neg_log_likelihood","text":"Computes negative log-likelihood regression model response assumed follow Compound Poisson-Normal distribution.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn_neg_log_likelihood.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Negative Log-Likelihood for Compound Poisson-Normal Regression ‚Äî cpn_neg_log_likelihood","text":"","code":"cpn_neg_log_likelihood(beta_mu_sigma, X, y, k_max = 10)"},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn_neg_log_likelihood.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Negative Log-Likelihood for Compound Poisson-Normal Regression ‚Äî cpn_neg_log_likelihood","text":"beta_mu_sigma Numeric vector. Contains regression coefficients log-link Poisson mean (lambda), followed mean (mu) standard deviation (sigma) Normal components. X Numeric matrix. design matrix regression model (rows = observations, columns = covariates). y Numeric vector. observed responses. k_max Integer. Maximum number Poisson events consider truncation likelihood approximation (default 10).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn_neg_log_likelihood.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Negative Log-Likelihood for Compound Poisson-Normal Regression ‚Äî cpn_neg_log_likelihood","text":"numeric value giving negative log-likelihood. Returns Inf invalid parameters provided numerical issues occur.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn_neg_log_likelihood.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Negative Log-Likelihood for Compound Poisson-Normal Regression ‚Äî cpn_neg_log_likelihood","text":"function computes likelihood observation weighted sum finite number Poisson-Normal mixtures, truncating k_max. resulting likelihood zero, function returns Inf penalize parameter set.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/cpn_neg_log_likelihood.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Negative Log-Likelihood for Compound Poisson-Normal Regression ‚Äî cpn_neg_log_likelihood","text":"","code":"X <- matrix(c(1, 2, 3, 4), ncol = 2) y <- c(0.5, 1.5) beta_mu_sigma <- c(0.1, 0.2, 1, 0.5) cpn_neg_log_likelihood(beta_mu_sigma, X, y, k_max = 10) #> [1] 3.42991"},{"path":"https://laszlopecze77.github.io/CPN/reference/emm_basis.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Basis for Estimated Marginal Means for Compound Poisson-Normal Models ‚Äî emm_basis.cpn","title":"Basis for Estimated Marginal Means for Compound Poisson-Normal Models ‚Äî emm_basis.cpn","text":"Provides required components computing estimated marginal means (EMMs) fitted Compound Poisson-Normal (CPN) model. method used emmeans package interface models class \"cpn\".","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/emm_basis.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Basis for Estimated Marginal Means for Compound Poisson-Normal Models ‚Äî emm_basis.cpn","text":"","code":"emm_basis.cpn(object, trms, xlev, grid, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/emm_basis.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Basis for Estimated Marginal Means for Compound Poisson-Normal Models ‚Äî emm_basis.cpn","text":"object fitted model object class \"cpn\" returned call e.g., cpn5(). trms Terms object extracted model formula, typically provided emmeans. xlev list levels factors reference grid. grid data frame representing reference grid EMMs computed. ... Additional arguments (currently unused).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/emm_basis.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Basis for Estimated Marginal Means for Compound Poisson-Normal Models ‚Äî emm_basis.cpn","text":"list components required emmeans: X Model matrix reference grid. bhat Estimated regression coefficients. V Variance-covariance matrix coefficients. nbasis matrix indicating penalized basis functions (empty case). dffun Function returning degrees freedom inference (fixed Inf). dfargs Arguments dffun. misc List transformation variance functions used EMM computations.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/fitted.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Fitted Values from a Compound Poisson-Normal (CPN) Model ‚Äî fitted.cpn","title":"Extract Fitted Values from a Compound Poisson-Normal (CPN) Model ‚Äî fitted.cpn","text":"method extracts fitted values model object class \"cpn\".","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/fitted.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Fitted Values from a Compound Poisson-Normal (CPN) Model ‚Äî fitted.cpn","text":"","code":"# S3 method for class 'cpn' fitted(object, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/fitted.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Fitted Values from a Compound Poisson-Normal (CPN) Model ‚Äî fitted.cpn","text":"object object class \"cpn\", typically returned model fitting function Compound Poisson-Normal regression. ... Additional arguments (currently unused).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/fitted.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Fitted Values from a Compound Poisson-Normal (CPN) Model ‚Äî fitted.cpn","text":"numeric vector fitted values.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/logLik.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Log-Likelihood from a CPN Model ‚Äî logLik.cpn","title":"Extract Log-Likelihood from a CPN Model ‚Äî logLik.cpn","text":"Returns log-likelihood fitted Compound Poisson-Normal (CPN) model.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/logLik.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Log-Likelihood from a CPN Model ‚Äî logLik.cpn","text":"","code":"# S3 method for class 'cpn' logLik(object, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/logLik.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Log-Likelihood from a CPN Model ‚Äî logLik.cpn","text":"object object class \"cpn\", typically resulting CPN model fitting function. ... Additional arguments (currently unused).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/logLik.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Log-Likelihood from a CPN Model ‚Äî logLik.cpn","text":"object class \"logLik\" representing log-likelihood. df attribute contains number estimated parameters.","code":""},{"path":[]},{"path":"https://laszlopecze77.github.io/CPN/reference/plot.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot Diagnostics for a CPN Model ‚Äî plot.cpn","title":"Plot Diagnostics for a CPN Model ‚Äî plot.cpn","text":"Generates diagnostic plots fitted Compound Poisson-Normal (CPN) model object. Options include residuals vs fitted values plot Q-Q plot deviance residuals.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/plot.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot Diagnostics for a CPN Model ‚Äî plot.cpn","text":"","code":"# S3 method for class 'cpn' plot(x, which = c(\"residuals\", \"qq\"), ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/plot.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot Diagnostics for a CPN Model ‚Äî plot.cpn","text":"x object class \"cpn\", typically resulting CPN model fitting function. character string specifying type plot produce. Options \"residuals\" (default) residuals vs fitted values plot, \"qq\" Q-Q plot deviance residuals. ... Additional graphical parameters passed underlying plotting functions.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/plot.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot Diagnostics for a CPN Model ‚Äî plot.cpn","text":"function called side effects return value.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/plot.cpn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot Diagnostics for a CPN Model ‚Äî plot.cpn","text":"residuals vs fitted plot helps assess non-linearity, unequal error variances, outliers. Q-Q plot checks normality deviance residuals.","code":""},{"path":[]},{"path":"https://laszlopecze77.github.io/CPN/reference/predict.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict Method for CPN Model Objects ‚Äî predict.cpn","title":"Predict Method for CPN Model Objects ‚Äî predict.cpn","text":"Computes predictions fitted Compound Poisson-Normal (CPN) regression model. Supports predictions link, rate, response scale, optional confidence intervals.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/predict.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict Method for CPN Model Objects ‚Äî predict.cpn","text":"","code":"# S3 method for class 'cpn' predict(   object,   newdata = NULL,   type = c(\"link\", \"rate\", \"response\"),   interval = c(\"none\", \"confidence\"),   level = 0.95,   ... )"},{"path":"https://laszlopecze77.github.io/CPN/reference/predict.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict Method for CPN Model Objects ‚Äî predict.cpn","text":"object object class cpn, typically result call function fitting Compound Poisson-Normal regression model. newdata optional data frame look variables predict. omitted, original model data used. type Type prediction: \"link\" returns linear predictor \\(\\eta = X\\beta\\); \"rate\" returns \\(\\exp(\\eta)\\); \"response\" returns mean response \\(E[Y] = \\mu \\cdot \\exp(\\eta)\\). interval Type interval calculation. Either \"none\" (default) \"confidence\" confidence intervals around predicted values. level Confidence level interval. Defaults 0.95. ... arguments passed methods (currently used).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/predict.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict Method for CPN Model Objects ‚Äî predict.cpn","text":"interval = \"none\", returns numeric vector predicted values specified scale. interval = \"confidence\", returns data frame columns: fit Predicted value lwr Lower bound confidence interval upr Upper bound confidence interval","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/predict.cpn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Predict Method for CPN Model Objects ‚Äî predict.cpn","text":"predictions response scale confidence intervals, standard errors linear predictor estimated mu parameter combined using delta method. Factor levels newdata aligned match used original model fit.","code":""},{"path":[]},{"path":"https://laszlopecze77.github.io/CPN/reference/predict.cpn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Predict Method for CPN Model Objects ‚Äî predict.cpn","text":"","code":"if (FALSE) { # \\dontrun{ fit <- cpn(y ~ x1 + x2, data = mydata) predict(fit, newdata = mynewdata, type = \"response\", interval = \"confidence\") } # }"},{"path":"https://laszlopecze77.github.io/CPN/reference/print.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Print method for Compound Poisson-Normal model objects ‚Äî print.cpn","title":"Print method for Compound Poisson-Normal model objects ‚Äî print.cpn","text":"Displays concise summary fitted Compound Poisson-Normal (CPN) regression model, including original function call, estimated coefficients, distribution parameters (mu sigma), residual deviance, degrees freedom, AIC.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/print.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print method for Compound Poisson-Normal model objects ‚Äî print.cpn","text":"","code":"# S3 method for class 'cpn' print(x, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/print.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print method for Compound Poisson-Normal model objects ‚Äî print.cpn","text":"x object class cpn. ... Additional arguments passed methods (currently ignored).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/print.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print method for Compound Poisson-Normal model objects ‚Äî print.cpn","text":"input object x, invisibly.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/print.summary.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Print Method for Summary of CPN Model ‚Äî print.summary.cpn","title":"Print Method for Summary of CPN Model ‚Äî print.summary.cpn","text":"Displays formatted summary fitted cpn model object, including parameter estimates, deviance residuals, model fit statistics.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/print.summary.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Print Method for Summary of CPN Model ‚Äî print.summary.cpn","text":"","code":"# S3 method for class 'summary.cpn' print(x, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/print.summary.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Print Method for Summary of CPN Model ‚Äî print.summary.cpn","text":"x object class \"summary.cpn\", returned summary.cpn(). ... Additional arguments passed print ignored.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/print.summary.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Print Method for Summary of CPN Model ‚Äî print.summary.cpn","text":"Invisibly returns summary.cpn object.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/recover_data.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Recover Data for cpn Model Objects ‚Äî recover_data.cpn","title":"Recover Data for cpn Model Objects ‚Äî recover_data.cpn","text":"method used emmeans package recover data terms fitted Compound Poisson-Normal (CPN) model object. typically used internally computing estimated marginal means.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/recover_data.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Recover Data for cpn Model Objects ‚Äî recover_data.cpn","text":"","code":"# S3 method for class 'cpn' recover_data(object, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/recover_data.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Recover Data for cpn Model Objects ‚Äî recover_data.cpn","text":"object fitted model object class cpn. ... Additional arguments (used).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/recover_data.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Recover Data for cpn Model Objects ‚Äî recover_data.cpn","text":"object containing recovered data terms, suitable use emmeans.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/residuals.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Residuals from a Compound Poisson-Normal (CPN) Model ‚Äî residuals.cpn","title":"Extract Residuals from a Compound Poisson-Normal (CPN) Model ‚Äî residuals.cpn","text":"method extracts residuals fitted model object class \"cpn\". Supports raw deviance residuals.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/residuals.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Residuals from a Compound Poisson-Normal (CPN) Model ‚Äî residuals.cpn","text":"","code":"# S3 method for class 'cpn' residuals(object, type = c(\"deviance\", \"raw\"), ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/residuals.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Residuals from a Compound Poisson-Normal (CPN) Model ‚Äî residuals.cpn","text":"object object class \"cpn\", typically produced CPN model fitting function. type Character string indicating type residuals return. Choices \"deviance\" (default) \"raw\". ... Additional arguments (currently unused).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/residuals.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Residuals from a Compound Poisson-Normal (CPN) Model ‚Äî residuals.cpn","text":"numeric vector residuals. Returns deviance residuals type = \"deviance\", raw residuals (observed - fitted) type = \"raw\".","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/simulate_cpn_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Simulate Data from a Compound Poisson-Normal Model ‚Äî simulate_cpn_data","title":"Simulate Data from a Compound Poisson-Normal Model ‚Äî simulate_cpn_data","text":"function generates synthetic data based Compound Poisson-Normal (CPN) model. number events observation drawn Poisson distribution, outcome sum normally distributed values event.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/simulate_cpn_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Simulate Data from a Compound Poisson-Normal Model ‚Äî simulate_cpn_data","text":"","code":"simulate_cpn_data(n = 100, beta = c(0.5, -0.3, 0.7), mu = 1, sigma = 2)"},{"path":"https://laszlopecze77.github.io/CPN/reference/simulate_cpn_data.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Simulate Data from a Compound Poisson-Normal Model ‚Äî simulate_cpn_data","text":"n Integer. Number observations simulate. Default 100. beta Numeric vector. Coefficients linear predictor, including intercept. Default c(0.5, -0.3, 0.7). Must match number columns model matrix: intercept, x1B, x2. mu Numeric. Mean Normal distribution event. Default 1. sigma Numeric. Standard deviation Normal distribution event. Default 2.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/simulate_cpn_data.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Simulate Data from a Compound Poisson-Normal Model ‚Äî simulate_cpn_data","text":"data.frame n rows 3 columns: y Numeric response variable generated CPN model. x1 Categorical predictor levels \"\" \"B\". x2 Continuous predictor drawn standard normal distribution.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/simulate_cpn_data.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Simulate Data from a Compound Poisson-Normal Model ‚Äî simulate_cpn_data","text":"predictors include binary categorical variable (x1) continuous variable (x2). linear model coefficients beta used model log Poisson rate.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/simulate_cpn_data.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Simulate Data from a Compound Poisson-Normal Model ‚Äî simulate_cpn_data","text":"","code":"set.seed(42) simulated_data <- simulate_cpn_data(n = 200) head(simulated_data) #>            y x1          x2 #> 1  0.0000000  A -0.71040656 #> 2 -2.4874819  A  0.25688371 #> 3  0.3583388  A -0.24669188 #> 4  0.0000000  B -0.34754260 #> 5  0.0000000  A -0.95161857 #> 6 16.0883605  B -0.04502772"},{"path":"https://laszlopecze77.github.io/CPN/reference/summary.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarize a Compound Poisson-Normal (CPN) Model Fit ‚Äî summary.cpn","title":"Summarize a Compound Poisson-Normal (CPN) Model Fit ‚Äî summary.cpn","text":"Produces summary fitted cpn model object, including parameter estimates, standard errors, z-values, p-values, deviance residual summaries, model diagnostics.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/summary.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarize a Compound Poisson-Normal (CPN) Model Fit ‚Äî summary.cpn","text":"","code":"# S3 method for class 'cpn' summary(object, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/summary.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarize a Compound Poisson-Normal (CPN) Model Fit ‚Äî summary.cpn","text":"object object class \"cpn\", see cpn(). ... Additional arguments (currently ignored).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/summary.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarize a Compound Poisson-Normal (CPN) Model Fit ‚Äî summary.cpn","text":"object class summary.cpn, list containing: call matched call generated model. summary_table data frame parameter estimates, standard errors, z-values, p-values. deviance_summary five-number summary (Min, 1Q, Median, 3Q, Max) deviance residuals. mu Estimated value Normal component mean. sigma Estimated value Normal component standard deviation. null_deviance Null deviance model. residual_deviance Residual deviance model. df_null Degrees freedom null model. df_residual Degrees freedom residual model. aic Akaike Information Criterion model comparison.","code":""},{"path":[]},{"path":"https://laszlopecze77.github.io/CPN/reference/summary.cpn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarize a Compound Poisson-Normal (CPN) Model Fit ‚Äî summary.cpn","text":"","code":"set.seed(123) n <- 100 x <- rnorm(n) lambda <- exp(0.5 + 0.2 * x) N <- rpois(n, lambda) # nolint y <- ifelse(N == 0, 0, rnorm(n, mean = N * 3, sd = sqrt(N) * 2)) fit <- cpn(y ~ x) summary(fit) #> Call: #> cpn(formula = y ~ x) #>  #> Deviance Residuals: #>    Min     1Q Median     3Q    Max  #> -2.741 -2.140 -1.681  2.407  3.149  #>  #> Coefficients: #>             Estimate Std.Error z.value      Pr.z     #> (Intercept)  0.49166   0.12165  4.0414 5.313e-05 *** #> x            0.20931   0.09367  2.2345   0.02545 *   #> --- #> Signif. codes:  0 ‚Äò***‚Äô 0.001 ‚Äò**‚Äô 0.01 ‚Äò*‚Äô 0.05 ‚Äò.‚Äô 0.1 ‚Äò ‚Äô 1 #>  #> Estimated mu parameter: 2.9067 #> Estimated sigma parameter: 1.5520 #>  #> Null deviance: 534.45 on 99 degrees of freedom #> Residual deviance: 529.60 on 96 degrees of freedom #> AIC: 537.60"},{"path":"https://laszlopecze77.github.io/CPN/reference/update.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Update a CPN Model with a New Formula or Data ‚Äî update.cpn","title":"Update a CPN Model with a New Formula or Data ‚Äî update.cpn","text":"Updates fitted Compound Poisson-Normal (CPN) model changing model formula data.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/update.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update a CPN Model with a New Formula or Data ‚Äî update.cpn","text":"","code":"# S3 method for class 'cpn' update(object, new_formula, data = NULL, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/update.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update a CPN Model with a New Formula or Data ‚Äî update.cpn","text":"object object class \"cpn\", typically produced CPN model fitting function. new_formula formula object specifying new model formula. data data frame containing new data. NULL, original data object used. ... Additional arguments passed underlying model fitting function.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/update.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Update a CPN Model with a New Formula or Data ‚Äî update.cpn","text":"new \"cpn\" object fitted updated formula /data.","code":""},{"path":[]},{"path":"https://laszlopecze77.github.io/CPN/reference/vcov.cpn.html","id":null,"dir":"Reference","previous_headings":"","what":"Variance-Covariance Matrix for a CPN Model ‚Äî vcov.cpn","title":"Variance-Covariance Matrix for a CPN Model ‚Äî vcov.cpn","text":"Computes variance-covariance matrix parameter estimates fitted Compound Poisson-Normal (CPN) regression model using numerical Hessian negative log-likelihood.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/vcov.cpn.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Variance-Covariance Matrix for a CPN Model ‚Äî vcov.cpn","text":"","code":"# S3 method for class 'cpn' vcov(object, ...)"},{"path":"https://laszlopecze77.github.io/CPN/reference/vcov.cpn.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Variance-Covariance Matrix for a CPN Model ‚Äî vcov.cpn","text":"object object class \"cpn\" returned cpn function. ... Additional arguments (currently unused).","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/vcov.cpn.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Variance-Covariance Matrix for a CPN Model ‚Äî vcov.cpn","text":"variance-covariance matrix model parameters. Rows columns named according model parameters (regression coefficients, mu, sigma). Hessian singular, contains NA values, otherwise invalid, matrix NA values returned appropriate warning.","code":""},{"path":"https://laszlopecze77.github.io/CPN/reference/vcov.cpn.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Variance-Covariance Matrix for a CPN Model ‚Äî vcov.cpn","text":"Hessian matrix negative log-likelihood computed using numerical finite differences (via hessian function). variance-covariance matrix obtained inverting Hessian. result reflects local curvature can used compute standard errors confidence intervals parameters.","code":""},{"path":[]},{"path":"https://laszlopecze77.github.io/CPN/reference/vcov.cpn.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Variance-Covariance Matrix for a CPN Model ‚Äî vcov.cpn","text":"","code":"set.seed(123) df <- data.frame(x = rnorm(100)) df$y <- sapply(exp(0.5 * df$x), function(lam) {   k <- rpois(1, lam)   if (k == 0) return(0)   sum(rnorm(k, mean = 1, sd = 1)) }) fit <- cpn(y ~ x, data = df) vcov(fit) #>              (Intercept)             x           mu         sigma #> (Intercept)  0.019229096 -0.0053012925 -0.007015153 -0.0042571726 #> x           -0.005301292  0.0169143475 -0.002521948  0.0008552595 #> mu          -0.007015153 -0.0025219477  0.016074768  0.0035950679 #> sigma       -0.004257173  0.0008552595  0.003595068  0.0145751698"}]
