
#' Find the K max
#'
#' description-find k.
#'
#' @param lambda the mean of the Poisson distribution
#' @param eposilon
#' @export

find_Kmax <- function(lambda, epsilon = 1e-6) {
  Kmax <- 0
  tail_prob <- 1 - stats::ppois(Kmax, lambda)

  while (tail_prob > epsilon) {
    Kmax <- Kmax + 1
    tail_prob <- 1 - stats::ppois(Kmax, lambda)
  }

  return(Kmax)
}
