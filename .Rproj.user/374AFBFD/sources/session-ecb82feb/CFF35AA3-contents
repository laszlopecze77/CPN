% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cpn.R
\name{cpn}
\alias{cpn}
\title{Fit a Compound Poisson-Normal (CPN) Regression Model}
\usage{
cpn(formula, data, mu_init = NULL, sigma_init = NULL, epsilon = 1e-06)
}
\arguments{
\item{formula}{A formula specifying the regression model.}

\item{data}{A data frame containing the variables in the model.}

\item{mu_init}{Optional initial value for the normal component mean.}

\item{sigma_init}{Optional initial value for the normal component standard deviation.}

\item{epsilon}{Numeric. Tail probability threshold for Poisson truncation (default is 1e-6).}
}
\value{
An object of class \code{"cpn"} containing:
\item{coefficients}{Estimated regression coefficients for the Poisson component}
\item{mu, sigma}{Estimated normal component parameters}
\item{se}{Standard errors of all parameters}
\item{formula, data}{Input formula and data}
\item{fitted_values}{Fitted means of the CPN distribution}
\item{deviance_residuals}{Deviance residuals}
\item{null_deviance, residual_deviance}{Deviance statistics}
\item{df_null, df_residual}{Degrees of freedom for null and fitted model}
\item{aic}{Akaike Information Criterion value}
\item{neg_log_likelihood}{Value of the minimized negative log-likelihood}
}
\description{
Fits a generalized regression model where the response is assumed to follow a
Compound Poisson-Normal (CPN) distribution. The Poisson intensity is modeled via
a log-link function with covariates.
}
\details{
The CPN model treats each observation as a sum of a Poisson-distributed number of
i.i.d. normal variables. This function fits the model using maximum likelihood,
computes standard errors from the Hessian (via finite differences),
and calculates diagnostics such as deviance and AIC.
}
\examples{
df <- data.frame(x1 = rnorm(100), x2 = runif(100))
df$y <- rpois(100, lambda = exp(0.5 * df$x1 - 0.3 * df$x2)) * 2 + rnorm(100)
model <- cpn(y ~ x1 + x2, data = df)
summary(model)

}
\seealso{
\code{\link{cpn_reg_mle}}, \code{\link{cpn_regression_neg_log_likelihood}},
\code{\link{find_Kmax}}, \code{\link{hessian_fd}}
}
