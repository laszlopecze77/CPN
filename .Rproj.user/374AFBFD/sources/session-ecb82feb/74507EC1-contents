#' Print Method for CPN Model Summary
#'
#' Displays a formatted summary of a Compound Poisson-Normal (CPN) model,
#' including the call, deviance residuals, regression coefficients, estimated
#' distribution parameters, and model fit statistics.
#'
#' @param x An object of class \code{"summary.cpn"}, typically the result of a call to \code{\link{summary.cpn}}.
#' @param ... Additional arguments passed to lower-level print functions (currently unused).
#'
#' @return The input object \code{x}, invisibly. This function is called for its side effects.
#'
#' @method print summary.cpn
#' @export
print.summary.cpn <- function(x, ...) {
  cat("Call:\n")
  print(x$call)

  cat("\nDeviance Residuals:\n")
  print(x$deviance_summary, digits = 4, quote = FALSE)

  cat("\nCoefficients:\n")
  stats::printCoefmat(x$summary_table, P.values = TRUE, has.Pvalue = TRUE)

  cat(sprintf("\nEstimated mu parameter: %.4f\n", x$mu))
  cat(sprintf("Estimated sigma parameter: %.4f\n", x$sigma))

  cat(sprintf("\nNull deviance: %.2f on %d degrees of freedom\n",
              x$null_deviance, x$df_null))
  cat(sprintf("Residual deviance: %.2f on %d degrees of freedom\n",
              x$residual_deviance, x$df_residual))
  cat(sprintf("AIC: %.2f\n", x$aic))

  invisible(x)
}
