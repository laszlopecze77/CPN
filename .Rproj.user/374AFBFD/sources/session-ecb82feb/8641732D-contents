#' Summarize a Compound Poisson-Normal (CPN) Model Fit
#'
#' Produces a summary for a fitted `cpn` model object, including parameter estimates,
#' standard errors, z-values, p-values, deviance residual summaries, and model diagnostics.
#'
#' @param object An object of class `"cpn"`, typically resulting from a call to a CPN regression function.
#' @param ... Additional arguments (currently ignored).
#'
#' @return An object of class `"summary.cpn"`, which is a list containing:
#' \describe{
#'   \item{call}{The matched call that generated the model.}
#'   \item{summary_table}{A data frame with parameter estimates, standard errors, z-values, and p-values.}
#'   \item{deviance_summary}{A five-number summary (Min, 1Q, Median, 3Q, Max) of deviance residuals.}
#'   \item{mu}{Estimated value of the Normal component mean.}
#'   \item{sigma}{Estimated value of the Normal component standard deviation.}
#'   \item{null_deviance}{Null deviance of the model.}
#'   \item{residual_deviance}{Residual deviance of the model.}
#'   \item{df_null}{Degrees of freedom for the null model.}
#'   \item{df_residual}{Degrees of freedom for the residual model.}
#'   \item{aic}{Akaike Information Criterion for model comparison.}
#' }
#'
#' @method summary cpn
#' @export
summary.cpn <- function(object, ...) {
  beta_hat <- object$coefficients
  se_hat <- object$se[1:length(beta_hat)]

  z_vals <- beta_hat / se_hat
  p_vals <- 2 * stats::pnorm(-abs(z_vals))
  param_names <- names(beta_hat)

  summary_table <- data.frame(
    Estimate = beta_hat,
    Std.Error = se_hat,
    z.value = z_vals,
    Pr.z = p_vals,
    row.names = param_names
  )

  dev_res <- object$deviance_residuals
  dev_summary <- stats::quantile(dev_res, probs = c(0, 0.25, 0.5, 0.75, 1))
  names(dev_summary) <- c("Min", "1Q", "Median", "3Q", "Max")

  out <- list(
    call = object$call,
    summary_table = summary_table,
    deviance_summary = dev_summary,
    mu = object$mu,
    sigma = object$sigma,
    null_deviance = object$null_deviance,
    residual_deviance = object$residual_deviance,
    df_null = object$df_null,
    df_residual = object$df_residual,
    aic = object$aic
  )
  class(out) <- "summary.cpn"
  return(out)
}
