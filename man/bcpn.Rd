% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bcpn.R
\name{bcpn}
\alias{bcpn}
\title{Bayesian Compound Poisson-Normal (bCPN) Regression Model}
\usage{
bcpn(
  formula,
  data,
  n_iter = 20000,
  burn_in = 5000,
  n_chains = 1,
  k_max = 10,
  priors = list(beta_0 = "dnorm(0, 0.000001)", beta_1 = "dnorm(0, 0.00001)", mu =
    "dnorm(0, 0.000000001)", sigma = "dgamma(0.01, 0.01)")
)
}
\arguments{
\item{formula}{A formula specifying the model. Must be either intercept-only
(\code{y ~ 1}) or contain exactly one binary factor (\code{y ~ factor}).}

\item{data}{A data frame containing the variables in the model.}

\item{n_iter}{Integer. Number of MCMC iterations to run after burn-in.
Default is 20,000.}

\item{burn_in}{Integer. Number of MCMC burn-in iterations. Default is 5,000.}

\item{n_chains}{Integer. Number of MCMC chains. Default is 1.}

\item{k_max}{Numeric scalar or NULL. Maximum truncation value for the Poisson
counts. Must be between 10 and 100. Default is 10.}

\item{priors}{A named list specifying prior distributions as JAGS model
strings. Defaults are:
\itemize{
\item \code{beta_0}: prior for intercept (default:
\code{"dnorm(0, 0.000001)"})
\item \code{beta_1}: prior for factor levels (default:
\code{"dnorm(0, 0.00001)"})
\item \code{mu}: prior for normal mean (default:
\code{"dnorm(0, 0.000000001)"})
\item \code{sigma}: prior for normal sd (default:
\code{"dgamma(0.01, 0.01)"})
}}
}
\value{
An \code{mcmc.list} object from the \code{coda} package containing
posterior samples for monitored parameters (including \code{mu},
\code{sigma}, \code{Expected}, and \code{Diff} if applicable).
}
\description{
Fits a Bayesian Compound Poisson-Normal regression model using JAGS.
Supports intercept-only or single binary factor models.
}
\details{
The model assumes the response follows a Compound Poisson-Normal
distribution where the count variable \(X\) is Poisson-distributed with a
log-linear model for its rate parameter, and the observations \(y\) are
normal with mean \(\eqn{\mu} X\) and variance \(\eqn{\sigma}^2 / X\) (with a large
variance if \(X=0\)).

The parameter \code{k_max} truncates the Poisson rate at a maximum value to
avoid numerical issues in JAGS.

Only models with an intercept or a single binary factor are supported.
}
\examples{
testdata <- simulate_cpn_data()
fit <- bcpn(y ~ x1, data = testdata, n_iter = 20000)
summary(fit)

}
