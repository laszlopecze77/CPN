% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cpn_regression_neg_log_likelihood.R
\name{cpn_regression_neg_log_likelihood}
\alias{cpn_regression_neg_log_likelihood}
\title{Negative Log-Likelihood for Compound Poisson-Normal Regression}
\usage{
cpn_regression_neg_log_likelihood(beta_mu_sigma, X, y, k_max = 10)
}
\arguments{
\item{beta_mu_sigma}{Numeric vector. Contains the regression coefficients
for the log-link Poisson mean (\code{lambda}), followed by the mean (\code{mu})
and standard deviation (\code{sigma}) of the Normal components.}

\item{X}{Numeric matrix. The design matrix for the regression model
(rows = observations, columns = covariates).}

\item{y}{Numeric vector. The observed responses.}

\item{k_max}{Integer. Maximum number of Poisson events to consider for
truncation in likelihood approximation (default is 10).}
}
\value{
A numeric value giving the negative log-likelihood. Returns
\code{Inf} if invalid parameters are provided or numerical issues occur.
}
\description{
Computes the negative log-likelihood for a regression model where
the response is assumed to follow a Compound Poisson-Normal distribution.
}
\details{
The function computes the likelihood for each observation as a
weighted sum over a finite number of Poisson-Normal mixtures,
truncating at \code{k_max}. If any resulting likelihood is zero, the function
returns \code{Inf} to penalize the parameter set.
}
\examples{
X <- matrix(c(1, 2, 3, 4), ncol = 2)
y <- c(0.5, 1.5)
beta_mu_sigma <- c(0.1, 0.2, 1, 0.5)
cpn_regression_neg_log_likelihood(beta_mu_sigma, X, y, k_max = 10)

}
