% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cpn_regression_neg_log_likelihood.R
\name{cpn_regression_neg_log_likelihood}
\alias{cpn_regression_neg_log_likelihood}
\title{Negative Log-Likelihood for Compound Poisson-Normal (CPN) Regression}
\usage{
cpn_regression_neg_log_likelihood(beta_mu_sigma, X, y, Kmax = 10)
}
\arguments{
\item{beta_mu_sigma}{Numeric vector. The parameter vector consisting of:
\itemize{
\item Regression coefficients \code{beta} for modeling \code{lambda} (length = \code{ncol(X)})
\item Scalar mean \code{mu} of the normal components
\item Scalar standard deviation \code{sigma} of the normal components
}}

\item{X}{Numeric matrix of covariates, with one row per observation.}

\item{y}{Numeric vector of response values, assumed to follow a CPN distribution.}

\item{Kmax}{Integer. Maximum number of Poisson terms to include when approximating the likelihood. Controls computational accuracy and speed.}
}
\value{
The negative log-likelihood (scalar). Returns \code{Inf} if \code{sigma <= 0} or
if any observation has a likelihood of zero (to avoid \code{log(0)}).
}
\description{
Computes the negative log-likelihood of a regression model where the response variable
follows a Compound Poisson-Normal (CPN) distribution. The Poisson rate parameter \code{lambda}
is modeled via a log-linear regression on covariates, and the normal components share a
common mean \code{mu} and standard deviation \code{sigma}.
}
\details{
The model assumes that the response \code{y} is a sum of a Poisson-distributed number
of i.i.d. normal variables. The Poisson intensity is linked to predictors via
\code{lambda_i = exp(X \%*\% beta)}. The likelihood is truncated by computing a finite sum
over a range of \code{k} values up to \code{Kmax}.
}
\examples{
set.seed(123)
X <- matrix(rnorm(20), ncol = 2)
y <- rpois(10, lambda = exp(X \%*\% c(0.5, -0.3))) * 2 + rnorm(10, 0, 1)
params <- c(0.5, -0.3, 2, 1)
cpn_regression_neg_log_likelihood(params, X, y)

}
